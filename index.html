<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Command Center</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #4f46e5; --bg: #0f172a; --card: #ffffff; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding: 15px; color: white; }
        .container { max-width: 500px; margin: auto; }
        .login-screen, .dashboard { display: none; }
        .active { display: block; }
        .card { background: var(--card); color: #1e293b; padding: 20px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 10px 15px rgba(0,0,0,0.2); }
        h2 { color: var(--primary); margin-top: 0; text-align: center; }
        .task-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #e2e8f0; }
        input[type="number"] { width: 60px; padding: 8px; border-radius: 8px; border: 1px solid #ccc; text-align: center; }
        button { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .export-btn { background: #10b981; margin-top: 20px; }
        input[type="password"] { width: 100%; padding: 15px; border-radius: 10px; border: none; margin: 15px 0; font-size: 24px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-screen" class="login-screen active">
        <div class="card" style="text-align: center;">
            <h2>Elite Portal</h2>
            <p style="color: #64748b;">Enter PIN to manage tasks</p>
            <input type="password" id="pin" inputmode="numeric" placeholder="••••">
            <button onclick="login()">Login</button>
        </div>
    </div>

    <div id="dashboard" class="dashboard">
        <h2>Daily Activity Score</h2>
        
        <div class="card">
            <h3 style="margin-top:0">Hemen's Tasks</h3>
            <div class="task-row"><span>Morning Routine</span> <input type="number" class="score" data-name="Hemen" data-task="Morning"></div>
            <div class="task-row"><span>School/Study</span> <input type="number" class="score" data-name="Hemen" data-task="Study"></div>
            <div class="task-row"><span>Daily Chores</span> <input type="number" class="score" data-name="Hemen" data-task="Chores"></div>
        </div>

        <div class="card">
            <h3 style="margin-top:0">Ablakat's Tasks</h3>
            <div class="task-row"><span>Morning Routine</span> <input type="number" class="score" data-name="Ablakat" data-task="Morning"></div>
            <div class="task-row"><span>School/Study</span> <input type="number" class="score" data-name="Ablakat" data-task="Study"></div>
            <div class="task-row"><span>Daily Chores</span> <input type="number" class="score" data-name="Ablakat" data-task="Chores"></div>
        </div>

        <button onclick="saveData()">Save Today's Scores</button>
        <button class="export-btn" onclick="exportExcel()">Download Result File (Excel)</button>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('elite_data')) || [];

    function login() {
        if(document.getElementById('pin').value === '4203') {
            document.getElementById('login-screen').classList.remove('active');
            document.getElementById('dashboard').classList.add('active');
        } else { alert('Wrong PIN'); }
    }

    function saveData() {
        const inputs = document.querySelectorAll('.score');
        const date = new Date().toLocaleDateString();
        inputs.forEach(input => {
            db.push({
                Date: date,
                Name: input.dataset.name,
                Task: input.dataset.task,
                Score: input.value || 0
            });
        });
        localStorage.setItem('elite_data', JSON.stringify(db));
        alert('Data Saved Locally!');
    }

    function exportExcel() {
        if(db.length === 0) return alert('No data to export!');
        const ws = XLSX.utils.json_to_sheet(db);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Scores");
        XLSX.writeFile(wb, "Elite_Center_Result.xlsx");
    }
</script>

</body>
</html>
